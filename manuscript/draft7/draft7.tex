\documentclass[review]{elsarticle}
%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
%% the following commands are needed for some matlab2tikz features
\usetikzlibrary{plotmarks}
\usetikzlibrary{arrows.meta}
\usepgfplotslibrary{patchplots}
\usepackage{grffile}
\usepackage{amsmath}
\pgfplotsset{ % Here we specify options for all figures in the document
	compat=1.8, % Which version of pgfplots do we want to use?
	legend style = {font=\small\sffamily}, % Legends in a sans-serif font
	label style = {font=\small\sffamily} % Labels in a sans-serif font
}
%% you may also want the following commands
%\pgfplotsset{plot coordinates/math parser=false}
%\newlength\figureheight
%\newlength\figurewidth
%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{graphicx}
\usepackage{subcaption}
\captionsetup[subfigure]{% changed <<<<<<<<<<<<<<<<
	singlelinecheck = false,
	justification=raggedright, 
	margin = {-3ex, 0mm}, % make margin font size dependent
	position=top
}

\usepackage{lineno}
\usepackage{makecell}
\usepackage[hidelinks]{hyperref}
\hypersetup{
    colorlinks,
    linkcolor={blue!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!50!black}
}
%\modulolinenumbers[5]
\usepackage{booktabs}
\journal{International Journal of Heat and Fluid Flow}

%%%%%%%%%%%%%%%%%%%%%%%
%% Elsevier bibliography styles
%%%%%%%%%%%%%%%%%%%%%%%


%% `Elsevier LaTeX' style
\bibliographystyle{elsarticle-num}
%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{xcolor}
\usepackage{float}
\usepackage{amsmath}

\usepackage{setspace}
\biboptions{sort&compress}
\setlength{\bibsep}{4pt}

\setlength{\abovecaptionskip}{-2pt plus 0pt minus 0pt}
\setlength{\belowcaptionskip}{2pt plus 0pt minus 0pt}

\newcommand{\ave}[1]{\left<{#1}\right>}

\begin{document}
\newlength\figureheight
\newlength\figurewidth
\begin{frontmatter}

\title{Critical Assessment of the Lattice Boltzmann Method for Cavitation Modelling based on Single Bubble Dynamics}
%% or include affiliations in footnotes:
\author[address_1]{Xin Xiong}
\author[address_1]{Tom-Robin Teschner\corref{mycorrespondingauthor}}
\cortext[mycorrespondingauthor]{Corresponding author}
\ead{tom.teschner@cranfield.ac.uk}
\author[address_1]{Irene Moulitsas}
\author[address_1]{Tam\'{a}s Istv\'{a}n J\'{o}zsa}


\address[address_1] { Centre for Computational Engineering Sciences, Cranfield University, Cranfield MK43 0AL, UK.}

\begin{abstract}
Cavitation, a phenomenon with both detrimental and advantageous implications, is contingent upon its method of application. The simulation of cavitation bubbles serves as a crucial means to enhance our understanding. The Lattice Boltzmann Method (LBM) has emerged as a widely employed technique for simulating bubble dynamics, with the Shan-Chen model standing out due to its simplicity and popularity. In the validation of LBM results, the Rayleigh-Plesset (R-P) equation is commonly employed. However, the literature often lacks a comprehensive examination of the influence of boundary conditions, initial conditions, and bubble radius in this validation process.
This article elucidates that in the validation of single bubble dynamics, careful consideration must be given to the impact of domain sizes, the initial conditions of the model, and the radius of the bubble. Our findings reveal that an increase in bubble radius results in heightened resolution, consequently extending the iterations required for the difference between LBM and R-P to reach 5\%. This 5\% refers to the point where the difference in bubble radius calculated by R-P and LBM methods reaches a 5\% discrepancy after a certain number of iterations. Additionally, varying the domain size while maintaining parameters ($R_{\infty}$) in R-P equation unchanged, results in disparate outcomes. Moreover, the initial conditions derived from LBM and implemented in the R-P equation significantly affect the predictive accuracy of the R-P equation concerning bubble evolution.
In contrast to existing literature that predominantly presents results with a singular domain size and initial condition, our research emphasizes the critical need to meticulously investigate the effects of domain size and to thoughtfully choose initial conditions informed by the LBM. We assert that the simulation of a single bubble based on LBM is not a straightforward process but demands thorough consideration.
\end{abstract}

\begin{keyword}
Lattice Boltzmann Simulation, Rayleigh-Plesset Equation, Single Bubble
\MSC[2010] 76D55
\end{keyword}


\end{frontmatter}

\linenumbers

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
Cavitation is a phenomenon that involves the transition from liquid to vapour due to a decrease in pressure, leading to the formation of vapour bubbles within the liquid. This phenomenon occurs in many hydrodynamic machines, where the collapse of cavitation bubbles can generate high pressure and high temperature, resulting in noise, vibration, and erosion. However, cavitation can be leveraged to enhance heat transfer and for applications such as drilling petroleum wells, where micro-jets induced by the collapse of bubbles play a crucial role \cite{peng2019simulation}.

Numerous numerical attempts have been made to simulate cavitation bubbles using traditional macroscopic methods based on the Navier-Stokes equation \cite{ogloblina2018simulation,shang2022investigation,koch2016numerical}. In particular, the Shan-Chen model has gained popularity for its simplicity in simulating bubble dynamics. This model employs a potential to mimic the interaction between particles, adding force to the velocity to trigger phase separation \cite{yuan2021modelling}. For instance, there are numerous articles that focus on studying a single bubble near a solid wall based on the Shan-Chen model \cite{liu2021study,yxl2020numerical,mao2018study}. Furthermore, simulations of a bubble near a concave wall  and a bubble near a solid particle \cite{peng2020simulation} have also been conducted. The advantages of the Shan-Chen model include its ability to easily incorporate the equation of state and facilitate the automatic separation of phases and components.

In articles studying bubble dynamics based on the Shan-Chen model, the validation of bubble growth or collapse was conducted by comparing the Rayleigh-Plesset (R-P) equation with Lattice Boltzmann Method (LBM) simulation results. Shi et al. \cite{shi2020numerical} compared the R-P equation with LBM simulation results for a bubble radius of 20, focusing on growth and collapse. The simulation domain size was 2000x2000x1000, but the article did not provide a detailed analysis of the grid convergence study. Ezzatneshan and Vaseghnia \cite{ezzatneshan2021dynamics} also validated LBM results for the same radius against the R-P equation under different pressures, determining the critical pressure for bubble growth or collapse. However, their study only considers a radius of 15, and the influence of different radii was not explored. Figure analysis reveals some discrepancies, especially at the end under certain pressure differences, possibly due to insufficient resolution at small radii.

Peng et al. \cite{peng2019simulation} compared LBM results with variable boundary pressure against the relevant R-P equation, demonstrating good agreement with slight deviations at the beginning. This suggests that initial conditions significantly influence the results. In another study, Peng et al. \cite{peng2018single} investigated LBM results with different pressure differences and radii against the R-P equation. While results were satisfactory in certain iterations, small deviations were observed. Unfortunately, their study lacked a detailed analysis of initial conditions and domain size.

Emphasizing these findings, it becomes evident that there is a notable research gap in the existing literature. Specifically, there is a lack of comprehensive analyses regarding the influence of different bubble radii, and detailed investigations into the effects of initial conditions and domain size on LBM simulations in the context of bubble dynamics based on the Shan-Chen model.

The primary aim of this article is to undertake a critical assessment of the Lattice Boltzmann method concerning its application to single bubble dynamics and, in turn, to establish a foundational framework for the simulation of bubble clusters. To realize this aim, the article is structured as follows:

In section two, the mathematical formulations governing the simulation, encompassing relevant equations, and the explication of the problem statement and setup are delineated. Section three delves into an in-depth presentation and discussion of results, focusing on the discernible impacts of the initial conditions, boundary conditions, and the radius of the bubble. The final section serves as the conclusion, synthesizing key insights and implications derived from the critical assessment presented in the preceding sections. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methodology}

\subsection{Equations of the Simulation}
In this article, a two-dimensional $D2Q9$ model was implemented based on the Shan-Chen multiphase model. The additional force was considered through the velocity shifting method by modifying the equilibrium velocity, without any alteration to the Lattice Boltzmann Equation, as expressed in \cite{kruger2017lattice}
\begin{linenomath*}
\begin{equation}
	f_i\left(x+e_i \Delta t, t+\Delta t\right)-f_i(x, t)=-\frac{1}{\tau}\left[f_i(x, t)-f_i^{e q}(x, t)\right],
\end{equation}
\end{linenomath*}
where represents one of the nine directions, $f$ is the density distribution function, $x$, $t$ are the coordinate in space and time, $\Delta t$ is the time step, $e_i$ is the unit vector direction of the lattice, $\tau$ is the relaxation time and $f^{eq}$ is the equilibrium density distribution function.
The equilibrium density distribution function can be expressed as \cite{mohamad2011lattice}
\begin{linenomath*}
\begin{equation}
	f_i^{e q}(x, t)=\omega_i \rho(x)\left[1+\frac{3 e_i \cdot u}{c^2}+\frac{9\left(e_i \cdot u\right)^2}{2 c^4}-\frac{3 u^2}{2 c^2}\right],
\end{equation}
\end{linenomath*}
where the weights $\omega_i$ are equal to 4/9 for $i=0$, 1/9 for $i=1$ to $4$, and 1/36 for $i=5$ to $9$; $c$ is the lattice speed; $\rho$ is the density; and $u$ is the macro velocity vector. The term $e_i$ represents the vector quantity of unit direction of lattice speed. According to Shan and Chen \cite{shan1993lattice}, the additional force can be expressed as
\begin{linenomath*}
\begin{equation}
	F(x, t)=-G \psi(x, t) \sum_{i=0}^8 \omega_i \psi\left(x+e_i t, t\right) e_i,
\end{equation}
\end{linenomath*}
where $G$ denotes the interaction strength between particles, and $\psi$ represents the effective density. Additionally, the velocity shifting method was implemented to enhance stability, as referenced in \cite{kruger2017lattice}
\begin{linenomath*}
\begin{equation}
	u^{\mathrm{eq}}=\frac{1}{\rho}\left(\sum_i f_i c_i+\tau F\right),
\end{equation}
\end{linenomath*}
where $F$ represents the Shan-Chen force vector and $u^{eq}$ is the vector of equilibrium velocity. Furthermore, the (Carnahan-Starling) C-S Equation of State (EOS) is incorporated through modifications to the effective density \cite{shi2020numerical}
\begin{linenomath*}
\begin{equation}
	\psi=\sqrt{\frac{2}{G c_s^2}\left(p-\rho c_s^2\right)},
\end{equation}
\end{linenomath*}
with different pressure $p$. In addition, $c_s$ is the speed of sound. The C-S equation of state \cite{peng2019simulation}
\begin{linenomath*}
\begin{equation}
	P=\rho R T \frac{1+b \rho / 4+(b \rho / 4)^2-(b \rho / 4)^3}{(1-b \rho / 4)^3}-a \rho^2,
\end{equation}
\end{linenomath*}
is implemented in this article with $a= 0.4963R^2T_c^2/P_c$,$b=0.18727RT_c^2/P_c$. Where $ a= 1, b= 4, R= 1$, the
critical temperature, pressure and density are $T_c = 0.09433, P_c=0.00441644$, and $\rho_c= 0.13044$. In this article, $T/T_c$ is set to 0.75, and the simulation is assumed to be isothermal.

Additionally, this article focuses on a two-dimensional LBM simulation within a square domain. Consequently, the associated R-P equation is derived using a cylindrical coordinate system, based on the principles of continuity and momentum equations, ultimately being formulated as \cite{brennen2014cavitation}
\begin{linenomath*}
\begin{equation}
	\ddot{R}=\left(\frac{P_v-P_{\infty}}{\rho_l}-\frac{\sigma}{\rho_l R} -\frac{2 \nu}{R} \dot{R}+\frac{1-\left(\frac{R}{R \infty}\right)^2}{2} \dot{R}^2-\ln \frac{R_{\infty}}{R} \dot{R}^2\right)/\left(\ln \frac{R_{\infty}}{R} \cdot R\right),
\label{equ:r-p}
\end{equation}
\end{linenomath*}
where $R$, $R_{\infty}$, $\dot{R}$, $\ddot{R}$, $\sigma$, $\nu$, $\rho_l$, $P_v$, $P_{\infty}$ are radius, the distance between the centre of the domain and the boundary, first derivative of the radius, second derivative of the radius, the surface tension, kinematic viscosity, liquid density, vapour pressure and pressure on the boundary. 
\subsection{Problem statement and the test cases}
In this article, two sets of problems are simulated based on the Shan-Chen model. One is a bubble in a square domain as in \ref{fig:schematic}(a); another is a flat interface simulation as sketched in Figure \ref{fig:schematic}(b). 
\begin{figure}[htp]
	\centering
	\includegraphics[width=0.6\textwidth]{schematic.png}
	\caption{Problem statement of the simulation (a) bubble simulation (b) flat interface simulation. The coordinate origin is placed in the centre of the domain in both cases}
	\label{fig:schematic}
\end{figure}
In both cases, the C-S EOS is implemented. The interaction strength $G$ cannot affect the results \cite{shi2020numerical}, since it will be eliminated during the calculation; therefore, it was set to -1 for simplicity. Numerical tests showed that a relaxation factor of $\omega=1$ provided acceptable stability and is chosen throughout this study
\subsubsection{Flat interface case}
In the flat interface case, the width of the domain $\Omega$, $L_x$, is set to 20 (lattice length unit) l.u., and the height, $L_y$, to 200 l.u. In the middle of the domain, it is set as gas phase with an initial density $\rho_g$ and pressure $p_g$ given. At the top and the bottom, the liquid phase is present, where initial pressure $p_l$ and density $\rho_l$ are implemented. To eliminate the effect of the boundary $\partial \Omega$, a periodic boundary condition is set in the flat interface simulation. In addition, the interface is also smoothed in the flat interface simulation (the width of interface is denoted as $W$ in equation \ref{equ:smooth1}) according to Huang et al. \cite{huang2019thermodynamic} as
\begin{linenomath*}
\begin{equation}
	\begin{aligned}
		\rho(y)= & \rho_v+\frac{\rho_l-\rho_v}{2} \times \operatorname{abs}\left\{\tanh \left[\frac{2(y-50)}{W}\right]\right. \\
		& \left.-\tanh \left[\frac{2(y-150)}{W}\right]\right\},
	\end{aligned}
\label{equ:smooth1}
\end{equation}
\end{linenomath*}
After reaching the equilibrium state, the densities of liquid and gas were recorded against each reduced temperature. The equilibrium state is defined as the condition when the change in density between two iterations is less than $10^{-4}$.
\subsubsection{Bubble case}
In the bubble simulation case, $L_x$ and $L_y$ are equal, forming a square domain in region $\Omega$. Inside the bubble, the gas pressure $p_g$ and the density of gas $\rho_g$ are set. Different bubble radii $R$ are set. In the bubble simulation, there are two minor problems with two boundary conditions $\partial \Omega$: one is a periodic boundary condition for Laplace law validation, and the other is the constant pressure $p_l$ and density $\rho_l$ boundary condition for R-P equation validation. In the Laplace law validation case, three radii of 20, 25, 30 with a domain size of 100 were set. In both bubble cases, an initial smooth interface was implemented on the bubble interface with 5 lattices for better stability according to Peng et al. \cite{peng2019simulation}.
\begin{linenomath*}
	\begin{align}
		\rho(x,y)&=\frac{\rho_{\text{liquid}}+\rho_{\text{vapor}}}{2}+\frac{\rho_{\text{liquid}}-\rho_{\text{vapor}}}{2} \cdot\notag \\
		&\tanh\left(\frac{2(\sqrt{(x-x_{0})^{2}+(y-y_{0})^{2}}-R_{init})}{5}\right)
	\end{align}
	\label{equ:smooth2}
\end{linenomath*}

In the constant pressure boundary condition case, a bounce-back boundary condition is set to validate the R-P equation. For stability reasons, the reduced temperature was chosen to be 0.75. The equilibrium densities of the liquid and gas, taken from Maxwell's area construction based on the C-S EOS, are 0.33 and 0.011, respectively. To trigger the growth and collapse of the bubble, densities different from the equilibrium density of the liquid on the boundary were implemented, which are 0.34 for collapse and 0.31 for growth, respectively. Furthermore, 1000 time steps were simulated for a sufficiently long time for bubble growth and collapse. The domain size for the bubble simulation is set to be square, including 100 (l.u), 200 (l.u), 400 (l.u) and 1000 (l.u).

The calculation of the radius is predicated on the average density of the liquid and gas at the brink of the bubble. The density of the liquid is computed as an average at a significant distance from the bubble, whereas the gas density is calculated as an average within the bubble, incorporating four cells at its centre. The justification for this approach stems from the premise that the density of a bubble remains nearly constant, both internally and externally. Averaging across four cells further mitigates issues related to small bubble sizes by ensuring that the calculation of gas density remains as accurate as possible. Furthermore, the pressure is averaged following the same strategy employed for density, and this averaged pressure is then incorporated into the R-P equation. Testing has demonstrated that the pressure remains relatively stable, indicating that variations in pressure averaging strategies—ranging from averaging across the entire bubble to averaging at the bubble's periphery—do not significantly impact the results.

In LBM simulations, the setup is an Initial Value Problem (IVP) where initial conditions like bubble radius and liquid density are set, but it also involves Boundary Value Problem (BVP) aspects, requiring boundary values at $\partial \Omega$. Conversely, the R-P equation primarily treats the problem as an IVP with boundaries at infinity, specifying initial $R$ and  $\dot{R}$ , underlining minimal distant boundary effects.

To analyse the impact of domain size, radius, and boundary condition in the bubble case with constant pressure boundary condition, different cases were carried out as follows in the table \ref{tab:cases}.
% Table generated by Excel2LaTeX from sheet 'Sheet1'
\begin{table}[htbp]
	\centering
	\caption{Different Cases}
	\begin{tabular}{llrr}
		\toprule
		\toprule
		& domain size & \multicolumn{1}{l}{radius} & \multicolumn{1}{l}{density} \\
		\midrule
		case1-4 & 100 200 400 1000 & 20    & 0.31 \\
		\midrule
		case5-8 & 100 200 400 1000 & 20    & 0.34 \\
		\midrule
		case9-13 & 100 200 400 1000 & 25    & 0.31 \\
		\midrule
		case14-17 & 100 200 400 1000 & 25    & 0.34 \\
		\midrule
		case18-21 & 100 200 400 1000 & 30    & 0.31 \\
		\midrule
		case22-25 & 100 200 400 1000 & 30    & 0.34 \\
		\midrule
		case26-29 & 100 200 400 1000 & 35    & 0.31 \\
		\midrule
		case30-32 & 100 200 400 1000 & 35    & 0.34 \\
		\bottomrule
		\bottomrule
	\end{tabular}%
	\label{tab:cases}%
\end{table}%
As can be seen from Table \ref{tab:cases}, there are a total of 32 cases, with each radius subjected to two situations of growth and collapse, and each situation was carried out with four domain sizes ranging from 100 to 1000.   

\section{Results and Discussion}
\subsection{Laplace Law validation}
As stated before in the previous section, Laplace law validation was first performed with three initial radii. As can be seen from Figure \ref{fig:lap-maxwell}(a), the bubble gradually evolves to the equilibrium state with periodic boundary conditions. According to the literature \cite{porter2012multicomponent,liu2010modified,ezzatneshan2021dynamics}, during this validation, the Laplace Law can be expressed as
\begin{linenomath}
\begin{equation}
	p_c=p_b-p_s=\frac{\sigma}{R},
	\label{equ:lap}
\end{equation}
\end{linenomath}
where $\sigma$ is the surface tension, $R$ is the radius, and $p_c, p_b, p_s$ are the capillary pressure, bubble, and suspending fluid pressure, respectively. As can be seen from Figure \ref{fig:lap-maxwell} (b), the results from LBM are in quite good agreement with the Laplace law. The slope is the surface tension as expressed in Equation \ref{equ:lap}.

In addition, to validate the thermodynamic consistency, the Maxwell Area construction was validated. As stated in the last section, the equilibrium densities are extracted at each temperature. For simplicity, the reference data were digitized from Peng et al. \cite{peng2019simulation}. As can be seen from Figure \ref{fig:lap-maxwell}(c), the LBM results are quite close to the reference data, which validates our code for thermodynamic consistency.
\begin{figure}[htp!]
	% y-axis tick label width
	\pgfplotsset{yticklabel style={text width=1.4em,align=left}}
	\pgfplotsset{xticklabel style={text width=1em,align=left}}
		\centering
		\setlength\figureheight{1\textwidth}
		\setlength\figurewidth{0.8\textwidth}
		\input{lap-max.tex}
		\caption{Laplace Law and Maxwell Area Construction (a) different bubble radius simulation (b) Laplace Law validation (c) Maxwell area Construction validation}
		\label{fig:lap-maxwell}
\end{figure}

\subsection{The impact of initial condition}
The outcomes obtained under distinct initial conditions in Figure \ref{fig:initial} manifest a noteworthy influence on the validation of LBM against the R-P equation. Particularly in the case of collapse scenarios, the R-P equation with the initial condition of LBM at time zero exhibits deviation in the initial stages. The observed trend indicates that with an escalation in the iterations from the initial condition in LBM, the disparity between LBM and R-P diminishes. This phenomenon may be attributed to the inherent instability of the LBM simulation during the initial phases, necessitating a mitigation of the influence of the initial condition. Notably, in the investigation conducted by Peng et al. \cite{peng2019simulation}, disparities are noted at the initial stages despite the implementation of variable pressure boundary conditions. 

The distinction in trends is more evident in Figure \ref{fig:initial} (c) (d), which illustrate the radius differences between the LBM and the R-P equation. It is observed that when the R-P equation is initialized using LBM conditions at t = 0 and t = 50 time units (t.u), there is a significant disparity in the results. However, initializing the R-P equation with LBM conditions at t = 100 t.u and t = 150 t.u yields a considerably smaller difference. The marginal reduction in disparity when moving from an initial condition at t = 100 t.u to t = 150 t.u suggests that t = 100 t.u is a sufficiently late time point for initializing the R-P equation for subsequent comparisons. This decision is supported by the minimal additional accuracy gain observed at t = 150 t.u, indicating that t = 100 t.u serves as an appropriate and pragmatic choice for initial conditions in later comparative analyses. In the study conducted by Ezzatneshan and Vaseghnia \cite{ezzatneshan2020simulation}, the graphical comparison between the LBM and the R-P equation, particularly in the context of minimal pressure differences, reveals a significant divergence between the two methods during the initial stages, underscores a notable divergence at the initial stages. This discrepancy prominently highlights the substantial influence of initial conditions on the validation and accuracy of LBM when compared against the R-P equation. The initial conditions play a pivotal role in determining the trajectory of the simulation outcomes, thereby reaffirming their critical importance in computational modeling and the comparative analysis of these two methods.  
\setlength{\abovecaptionskip}{10pt} % Set the space above the caption
\begin{figure}[htp!]
	\centering
	\pgfplotsset{yticklabel style={text width=1.19em, align=left}}
	\pgfplotsset{xticklabel style={text width=2em, align=left}}
	\setlength\figureheight{0.9\textwidth}
	\setlength\figurewidth{0.8\textwidth}
	\input{initial.tex} % Adjust the width as needed
	\caption{The impact of initial condition. R-P equation with initial condition of LBM at time 0,50,100,150. (a) growth case (b) collapse case (c) radius difference of growth case (d) radius difference of collapse case }
	\label{fig:initial}
\end{figure}
\newpage
\subsection{The impact of domain size}
In the data delineated in Figure \ref{fig:domain}, variations in domain size yield disparate results when compared with the R-P equation. Furthermore, it is demonstrated that the outcomes are influenced by the parameter $R_{\infty}$, which is set to average within a quarter of the square domain. Figure \ref{fig:domain} (a), (b), (c), and (d) present the outcomes associated with domain sizes of 100, 200, 400, and 1000, respectively. Specifically, we define a critical point for each domain size iteration: this is the juncture at which the deviation between the R-P equation's predictions and the LBM outcomes crosses a threshold of 5\%. Notably, in the context of growth scenarios with the same $R_{\infty}$ setting, the domain sizes of 400 and 100 exhibit inferior performance compared to those of 1000 and 200. This phenomenon may be attributed to the differential impact of domain size on the simulation outcomes. Conversely, in collapse scenarios, a satisfactory match is observed only with the domain size of 100, suggesting that the radius is a primary influencing factor—a topic that warrants further investigation. For collapse cases, the influence of the boundary diminishes in larger domain sizes; hence, maintaining the same $R_{\infty}$ setting leads to some discrepancies. In the study conducted by Shi et al. \cite{shi2020numerical}, the domain size is established at 2000x2000x1000, a dimension considered sufficiently large to minimize boundary effects. In the research conducted by Ezzatneshan and Vaseghnia \cite{ezzatneshan2020simulation}, the chosen domain size for the simulation of a single bubble is 50x50x50. However, the authors do not provide a detailed rationale for this specific selection of domain dimensions. Notably, certain discrepancies can be observed in their figures, the origins of which might be attributed to this choice of domain size. Furthermore, in their study, Peng et al. \cite{peng2019simulation} employed two distinct domain sizes, 400x400 and 600x600, for validation purposes. Although they acknowledged that the evolution of the bubble is influenced by the domain size, a comprehensive grid independence study was not conducted. Peng et al. attributed the impact on bubble evolution to the R-P equation; however, they did not thoroughly investigate the influence of domain size within the context of the LBM simulations. Nonetheless, this analysis underscores the necessity of careful consideration regarding the impact of boundaries, as their influence remains notable even in considerably large domains, particularly after a certain iteration threshold is surpassed.
% Adjust the space between figure and caption
\setlength{\abovecaptionskip}{20pt} % Set the space above the caption
\begin{figure}[htp!]
	\centering
	\pgfplotsset{yticklabel style={text width=1.1em, align=left}}
	\pgfplotsset{xticklabel style={text width=2em, align=left}}
	\setlength\figureheight{1.0\textwidth}
	\setlength\figurewidth{0.8\textwidth}
	\input{domainsize.tex} % Adjust the width as needed
	\caption{The impact of domain size on growth and collapse case for radius 30. (a) domain size=100, (b) domain size=200, (c) domain size=400, (d) domain size=1000}
	\label{fig:domain}
\end{figure}

\begin{figure}[htp!]
	\centering
	\includegraphics[scale=0.4]{contour.png}
	\caption{density contour of bubble with domain size 400 and initial radius=30. (a) iteration=0, (b) iteration=100, (c) iteration=200, (d) iteration=500}
	\label{fig:con}
\end{figure}

The discrepancy observed in the final stages of collapse can be attributed to significant diffusion effects, particularly when the bubble diminishes to a minimal size. As illustrated in Figure \ref{fig:con}(d), which shows a close-up contour, pronounced diffusion is evident during the imminent collapse phase of the bubble. Furthermore, the choice of pressure averaging strategy contributes marginally to the variations in outcomes. For the purposes of this study, a centred-pressure averaging strategy was employed to maintain methodological simplicity. In the modified R-P equation, the parameter $R_{\infty}$ is adjusted due to the original formulation's assumption of an infinite boundary, which impacts the outcomes. It is conceivable that in existing literature, this parameter has been fine-tuned to align the results of the R-P equation with those obtained from LBM simulations. However, there is no universally optimized parameter that is applicable across all cases. The selection of the parameter in this article is based on an area-weighted length within a quarter of a square domain. The average length, $L_{avg}$, can be calculated using an integral that accounts for the variation of length within this domain. Given that the minimum length is half the domain length (0.5×domain) and the maximum length within the quarter of the square domain, considering the geometry and the angle at $45^\circ$, is (half domain × $\sqrt{2}$). To calculate $L_{avg}$, we integral over the angle from 0 to $\pi/4$, considering the length as a function of the angle $\alpha$, which is represented by $L(\alpha)=\frac{half domain}{cos\alpha}$, the integral formula to find
$L_{avg}$ is $L_{avg} = \frac{1}{\pi/4} \int_{0}^{\pi/4} \left( \frac{\text{half domain}}{\cos(\alpha)} \right) d\alpha$.
%\newpage
\subsection{The impact of radius}
In the analysis of radius-related outcomes depicted in Figure \ref{fig:radius}, a discernible trend is observed, whereby an increase in the radius correlates with a rise in the specific iterations required to achieve a 5\% discrepancy. This pattern is particularly pronounced when comparing a radius of 350 (l.u.) with one of 35 (l.u.), where the iterations necessary to reach the 5\% difference threshold are significantly more extended for the larger radius. Notably, the relationship between the radius and the number of iterations appears to be almost linear. Furthermore, towards the end of the simulation, the radius difference consistently remains substantial, potentially attributable to the inadequate resolution when dealing with smaller bubbles. This observation underscores the pivotal role of radius in impacting the outcomes of simulations. The fundamental cause of this phenomenon is the resolution insufficiency encountered at smaller radii, resulting in diminished simulation precision. This conclusion is in concordance with the findings presented by Ezzatneshan and Vaseghnia \cite{ezzatneshan2021dynamics}, who reported a decreasing discrepancy with increasing radius in the initial phases of their study. Similarly, the research by Peng et al. \cite{peng2019simulation} on a growth case showed a marked deviation towards the end of the simulation, especially pronounced at smaller radii.

Furthermore, the study conducted by Gai et al. \cite{gai2022lbm} also provides empirical evidence in support of this observation. Their findings, particularly in the context of the collapse case simulations, reveal discernible discrepancies between the results obtained from the LBM and those predicted by the R-P equation towards the end of the simulation. This outcome further corroborates the assertion that adequate resolution, particularly in terms of the radius, is imperative for the accuracy of LBM simulations. Additionally, the research conducted by Peng et al. \cite{peng2018single} provides further evidence of this phenomenon. Particularly in the collapse case simulations, their findings exhibit certain discrepancies. This observation lends credence to the theory that when the bubble diminishes in size, the resolution employed in the simulation may not be sufficiently large to accurately capture the complexities of the process. 
\setlength{\abovecaptionskip}{10pt} % Set the space above the caption
\begin{figure}[htp]
	\centering
	\pgfplotsset{yticklabel style={text width=1.1em, align=left}}
	\pgfplotsset{xticklabel style={text width=2em, align=left}}
	\setlength\figureheight{0.8\textwidth}
	\setlength\figurewidth{0.8\textwidth}
	\input{radius.tex} % Adjust the width as needed
	\caption{The impact of radius with domain size 1000 (l.u.) and initial condition from LBM at time 100. (a) radius from 20 to 35, (b) log-log plot radius including 20,25 30,35,350 }
	\label{fig:radius}
\end{figure}
\newpage
\section{Conclusions}
This article performed the LBM simulation of a single bubble based on the
Shan-Chen Model. Then validate the results with R-P equation. Based on the provided results and discussion, the following conclusion can be drawn,
\begin{itemize}
	\item Incorporating the initial conditions derived directly from the LBM at the inception point (t=0 t.u.) into the R-P equation reveals a substantial discrepancy between the two models. This significant variance underscores the sensitivity of the R-P equation to the initial state provided by LBM simulations. As the investigation progresses, applying initial conditions from subsequent time steps within the LBM framework demonstrates an improvement in the congruence between the models. Specifically, when initial conditions from the LBM at time 100 (t.u.) are employed, as opposed to those at the very start, a notable enhancement in alignment is observed. However, extending this approach to initiate the R-P equation with conditions from LBM at time 150 (t.u.) yields only a marginal further reduction in the difference between the two models. This observation suggests that while advancing the point of initial condition extraction from the LBM simulations contributes to diminishing the discrepancy with the R-P equation, the benefits of this strategy exhibit diminishing returns. Consequently, the selection of the initial condition at time 100 (t.u.) is deemed optimal for subsequent analyses, balancing improvement in model agreement against the diminishing returns observed with later initial conditions
	\item The domain size and the parameter \(R_{\infty}\) play pivotal roles in aligning the results between the LBM and the R-P equation. The parameter \(R_{\infty}\) defines the distance from the center of the bubble to the domain boundary. Notably, in LBM, the domain is square, whereas it is cylindrical in the context of the R-P equation. This discrepancy leads to a difference in the influence of the boundary of domain between LBM and the R-P equation. However, there is no established methodology for determining the optimal value of \(R_{\infty}\). It has been observed that there is no universally optimal \(R_{\infty}\) that is applicable across all domain sizes, as each domain size uniquely influences the outcomes. The literature suggests that authors may fine-tune $R_{\infty}$ to achieve congruence between the LBM and R-P equation results.
	\item An analysis of the simulation data reveals an approximately linear relationship between the radius and the iteration at which the difference between the LBM and the R-P equation reaches a 5\% threshold. Furthermore, a consistent observation towards the end of the simulation is the presence of a significant discrepancy. This is largely attributed to the insufficient resolution within the bubble when it becomes exceedingly small, thereby impacting the accuracy of the simulation.  
\end{itemize}
This study serves as a foundational
exploration preceding future endeavours in simulating bubble cluster dynamics.
\section*{Acknowledgements}
This project was financially supported by the Centre for Computational Engineering Sciences at Cranfield University under project code 15124. Furthermore, we would like to acknowledge the IT support for using the High-Performance Computing (HPC) facilities at Cranfield University, UK.
%\appendix
%\section{some appendix}\label{app:A}
\section*{Data Availability}
Data supporting this study will be available from \url{https://github.com/xiongxin9000/SINGLE-BUBBLE.git}
%\section*{References}

{\begingroup
\singlespacing
\footnotesize
\bibliography{mybibliography}
\endgroup}

\end{document}